<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="layout :: body">
<section>
  <!-- Page Header -->
  <div class="page-header">
    <div class="row align-items-center">
      <div class="col-md-8">
        <h1 class="mb-0">
          <i class="fas fa-exchange-alt me-3"></i>Histórico de Transações
        </h1>
        <p class="mb-0 mt-2 opacity-75">Visualize todas as transações realizadas no sistema</p>
      </div>
      <div class="col-md-4 text-md-end">
        <a th:href="@{/ui/contas}" class="btn btn-outline-light btn-lg">
          <i class="fas fa-arrow-left me-2"></i>Voltar para Contas
        </a>
      </div>
    </div>
  </div>

  <!-- Account Info (if viewing specific account) -->
  <div th:if="${conta}" class="row justify-content-center mb-4">
    <div class="col-lg-10">
      <div class="bank-card p-4">
        <div class="row align-items-center">
          <div class="col-md-8">
            <h4 class="fw-bold mb-2">
              <i class="fas fa-credit-card me-2"></i>Conta <span th:text="${conta.numero}"></span>
            </h4>
            <div class="row">
              <div class="col-md-4">
                <div class="d-flex align-items-center mb-2">
                  <i class="fas fa-user me-2 text-muted"></i>
                  <span th:text="${conta.cliente.nome}"></span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="d-flex align-items-center mb-2">
                  <i class="fas fa-dollar-sign me-2 text-muted"></i>
                  <span class="fw-bold text-success fs-5" th:text="'R$ ' + ${#numbers.formatDecimal(conta.saldo, 1, 2)}"></span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="d-flex align-items-center mb-2">
                  <i class="fas fa-exchange-alt me-2 text-muted"></i>
                  <span th:text="${transacoes != null ? #lists.size(transacoes) : 0}"></span> transações
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4 text-md-end">
            <div class="account-status">
              <span class="badge bg-success fs-6">
                <i class="fas fa-check-circle me-1"></i>Ativa
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="row g-4 mb-4">
    <div class="col-md-3">
      <div class="bank-card text-center p-4">
        <div class="stats-icon mb-3">
          <i class="fas fa-exchange-alt text-primary" style="font-size: 2.5rem;"></i>
        </div>
        <h3 class="fw-bold mb-1" th:text="${transacoes != null ? #lists.size(transacoes) : 0}">0</h3>
        <p class="text-muted mb-0">Total de Transações</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="bank-card text-center p-4">
        <div class="stats-icon mb-3">
          <i class="fas fa-plus-circle text-success" style="font-size: 2.5rem;"></i>
        </div>
        <h3 class="fw-bold mb-1">0</h3>
        <p class="text-muted mb-0">Depósitos</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="bank-card text-center p-4">
        <div class="stats-icon mb-3">
          <i class="fas fa-minus-circle text-warning" style="font-size: 2.5rem;"></i>
        </div>
        <h3 class="fw-bold mb-1">0</h3>
        <p class="text-muted mb-0">Saques</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="bank-card text-center p-4">
        <div class="stats-icon mb-3">
          <i class="fas fa-chart-line text-info" style="font-size: 2.5rem;"></i>
        </div>
        <h3 class="fw-bold mb-1">R$ 0,00</h3>
        <p class="text-muted mb-0">Volume Total</p>
      </div>
    </div>
  </div>

  <!-- Transactions Table -->
  <div class="bank-card">
    <div class="card-header bg-transparent border-0 p-4">
      <div class="row align-items-center">
        <div class="col-md-6">
          <h4 class="mb-0">
            <i class="fas fa-list me-2"></i>Lista de Transações
          </h4>
        </div>
        <div class="col-md-6">
          <div class="input-group">
            <span class="input-group-text">
              <i class="fas fa-search"></i>
            </span>
            <input type="text" class="form-control" placeholder="Buscar transações..." id="searchInput">
          </div>
        </div>
      </div>
    </div>
    
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0" id="transactionsTable">
          <thead>
            <tr>
              <th class="border-0">
                <i class="fas fa-hashtag me-2"></i>ID
              </th>
              <th class="border-0">
                <i class="fas fa-tag me-2"></i>Tipo
              </th>
              <th class="border-0">
                <i class="fas fa-dollar-sign me-2"></i>Valor
              </th>
              <th class="border-0">
                <i class="fas fa-calendar me-2"></i>Data/Hora
              </th>
              <th class="border-0">
                <i class="fas fa-credit-card me-2"></i>Conta
              </th>
              <th class="border-0">
                <i class="fas fa-user me-2"></i>Cliente
              </th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="transacao : ${transacoes}">
              <td>
                <span class="badge bg-primary">#<span th:text="${transacao.id}"></span></span>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <div class="transaction-icon me-3">
                    <i th:if="${transacao.tipo == 'DEPOSITO'}" class="fas fa-plus-circle text-success" style="font-size: 1.5rem;"></i>
                    <i th:if="${transacao.tipo == 'SAQUE'}" class="fas fa-minus-circle text-warning" style="font-size: 1.5rem;"></i>
                    <i th:if="${transacao.tipo == 'TRANSFERENCIA'}" class="fas fa-exchange-alt text-info" style="font-size: 1.5rem;"></i>
                  </div>
                  <div>
                    <span th:if="${transacao.tipo == 'DEPOSITO'}" class="badge bg-success">Depósito</span>
                    <span th:if="${transacao.tipo == 'SAQUE'}" class="badge bg-warning">Saque</span>
                    <span th:if="${transacao.tipo == 'TRANSFERENCIA'}" class="badge bg-info">Transferência</span>
                  </div>
                </div>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <span class="fw-bold fs-5" 
                        th:class="${transacao.tipo == 'DEPOSITO'} ? 'text-success' : 'text-warning'"
                        th:text="'R$ ' + ${#numbers.formatDecimal(transacao.valor, 1, 2)}">
                  </span>
                </div>
              </td>
              <td>
                <div class="d-flex flex-column">
                  <span class="fw-bold" th:text="${#temporals.format(transacao.dataHora, 'dd/MM/yyyy')}"></span>
                  <small class="text-muted" th:text="${#temporals.format(transacao.dataHora, 'HH:mm')}"></small>
                </div>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <div class="account-icon me-3">
                    <i class="fas fa-credit-card text-primary" style="font-size: 1.2rem;"></i>
                  </div>
                  <div>
                    <div class="fw-bold" th:text="${transacao.conta.numero}"></div>
                    <small class="text-muted">Conta</small>
                  </div>
                </div>
              </td>
              <td>
                <div class="d-flex align-items-center">
                  <div class="avatar me-3">
                    <i class="fas fa-user-circle text-muted" style="font-size: 1.5rem;"></i>
                  </div>
                  <div>
                    <div class="fw-bold" th:text="${transacao.conta.cliente.nome}"></div>
                    <small class="text-muted" th:text="${transacao.conta.cliente.cpf}"></small>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div th:if="${transacoes == null || #lists.isEmpty(transacoes)}" class="row justify-content-center mt-5">
    <div class="col-lg-6">
      <div class="bank-card text-center p-5">
        <div class="empty-state-icon mb-4">
          <i class="fas fa-exchange-alt text-muted" style="font-size: 4rem;"></i>
        </div>
        <h4 class="fw-bold mb-3">Nenhuma transação encontrada</h4>
        <p class="text-muted mb-4">
          Ainda não há transações registradas no sistema. 
          <span th:if="${conta}">Realize depósitos ou saques para ver as transações aqui.</span>
          <span th:if="${conta == null}">As transações aparecerão aqui conforme forem realizadas.</span>
        </p>
        <a th:href="@{/ui/contas}" class="btn btn-primary">
          <i class="fas fa-credit-card me-2"></i>Ver Contas
        </a>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const searchInput = document.getElementById('searchInput');
  const table = document.getElementById('transactionsTable');
  
  if (table) {
    const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
    
    searchInput.addEventListener('keyup', function() {
      const filter = this.value.toLowerCase();
      
      for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const cells = row.getElementsByTagName('td');
        let found = false;
        
        for (let j = 0; j < cells.length; j++) {
          if (cells[j].textContent.toLowerCase().indexOf(filter) > -1) {
            found = true;
            break;
          }
        }
        
        row.style.display = found ? '' : 'none';
      }
    });
  }
});
</script>
</html>
